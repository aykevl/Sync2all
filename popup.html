<!DOCTYPE html>

<html>
<head>
	<meta name="encoding" content="utf-8" />

<script src="utils.js"></script>
<script type="text/javascript">

var background = chrome.extension.getBackgroundPage();

function popupClosed() {
	background.popup_ui_update = undefined;
}

// TODO change this to a more fine-grained system.
function updatePopup() {
	var target;
	for (var i=0; target=background.remotes[i]; i++) {
		target.popup_update(document); // TODO popup_update expects div element
	}
}

background.popup_ui_update = updatePopup;

</script>
<style>
body {
	text-align: right;
}
.target {
	border: 1px darkgrey solid;
	white-space: nowrap;
}
</style>
</head>

<body onload="updatePopup();" onunload="popupClosed();">

<div id="target_gbm" class="target">
	<strong>Google Bookmarks:</strong> <span id="gbm_status">Ready</span><br />
	<button id='gbm_button_start' onclick="background.gbm.start();" title="Start synchronizing with Google Bookmarks. Will continue to sync, even after a restart.">Synchronize</button><br />
	<!--<button id='gbm_button_noremove' onclick="localStorage.gbm_lastSync=0; updatePopup();" title="This sets the 'last-synchronized' time to zero, so that all bookmarks seem to be new. This will be reset after a synchronisation has completed.">Keep old bookmarks</button><br />-->
	<button id='gbm_button_stop' onclick="background.gbm.stop();" title="Stop synchronizing with Google Bookmarks">Stop synchronizing</button>
</div>

<div id="target_opl" class="target">
</div>

</body>

</html>
